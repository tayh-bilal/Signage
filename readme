# üì∫ Digital Signage Player

A high-performance, auto-updating Electron application designed to synchronize video content across muti screens. This player uses a global clock synchronization method and a Supabase backend to ensure all screens play the same content at the exact same millisecond.

## üöÄ Key Features
* **Global Sync:** Uses time-offset logic to ensure frame-accurate synchronization across multiple devices.
* **Dynamic Polling:** * **Idle Mode:** Checks for new content every 10 seconds when no video is assigned.
    * **Playback Mode:** Checks for updates every 60 minutes to save bandwidth.
* **Background Auto-Updates:** Downloads new app versions silently and restarts automatically via GitHub Releases.
* **Hardware-Based Identity:** Automatically generates a unique "Clean ID" from the device's MAC address (e.g., `08EDB99EB573`).

---

## üõ† Project Structure
* `main.js`: Controls the Electron process, power management (prevents sleep), and the update engine.
* `player.html`: The core logic for video rendering, time-syncing, and polling Supabase.
* `package.json`: Manages dependencies and version control.
* `.gitignore`: Prevents heavy folders (`node_modules`, `dist`) from bloating the code repository.

---

## üîÑ How to Update the Code (Workflow)

When you need to change the player's behavior or fix a bug, follow these exact steps to update all the screens remotely.

### 1. Edit the Code
Make your changes locally in `player.html` or `main.js`. Test the changes by running:
```powershell
npm start



2. Increment the Version
The screens will only update if they detect a higher version number.

Open package.json.

Change "version": "1.0.4" to "version": "1.0.5" (or higher).

3. Build the Installer
Run the distribution script to package the app for Windows.

PowerShell:
rm -rf node_modules dist
npm install
npm run dist

Upload code to GitHub

Upload the installer to GitHub by making a new release.

This will generate a dist/ folder containing:

signage-player Setup 1.0.5.exe (The installer)

latest.yml (The "instruction" file for the auto-updater)


            
4. Launch the New Version (GitHub Release)
The screens monitor the Releases section of this repository.
Go to your GitHub Repo -> Releases -> Draft a new release.
Tag version: v1.0.5 (must match package.json).
Upload Assets: Drag and drop BOTH the .exe and the latest.yml from your dist/ folder.
Publish Release.

üì° The Update Lifecycle
Once you click Publish, the following happens automatically:
Detection: Within 60 minutes, the player checks GitHub and sees a new version is available.
Silent Download: The player downloads the new installer in the background while the current video continues to play.
Self-Installation: Once the download is 100% complete, the app calls quitAndInstall().
Auto-Restart: The app closes, installs the update, and relaunches within 10 seconds.
Recovery: The player reads the existing screen-config.json, identifies itself, and resumes the playlist.

üîß New Screen Setup
Download the latest .exe from the Releases tab.
Install on a Windows PC.
On first launch, a Green ID (MAC Address) will appear on the clock screen.
Add this ID to your Supabase screens table to begin pushing content.

‚å®Ô∏è Local Controls
F11: Toggle Fullscreen.
Arrow Right / Left: Adjust time offset (+/- 0.05s) to fine-tune synchronization.
Ctrl+R: Force Reload.

üîßHow to install on a new device?

run on powershell

# ===============================================
# FULL AUTOMATIC INSTALLER - LATEST RELEASE
# You control the install path
# ===============================================

# ===============================================
#  AUTO-INSTALLER (RESILIENT VERSION)
# ===============================================

# 1. SETTINGS
$repo = "tayh-bilal/Signage"
$installFolder = "$env:LOCALAPPDATA\Programs\signage-player"
$installerPath = "$env:TEMP\SignagePlayerInstaller.exe"
$shortcutPath = "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\SignagePlayer.lnk"

Write-Host "Checking for updates..." -ForegroundColor Cyan

# 2. GET LATEST RELEASE (Ignore Drafts)
try {
    $latestRelease = Invoke-RestMethod "https://api.github.com/repos/$repo/releases/latest"
} catch {
    Write-Host "ERROR: Could not find any releases on GitHub. Is the repo public?" -ForegroundColor Red
    return
}

Write-Host "Found Version: $($latestRelease.tag_name)" -ForegroundColor Green

# 3. FIND ANY .EXE FILE (Don't worry about the exact name)
$asset = $latestRelease.assets | Where-Object { $_.name -like "*.exe" } | Select-Object -First 1

if (-not $asset) { 
    Write-Host "CRITICAL ERROR: No .exe file found in release $($latestRelease.tag_name)!" -ForegroundColor Red
    Write-Host "Available files:"
    $latestRelease.assets | ForEach-Object { Write-Host " - $($_.name)" -ForegroundColor Yellow }
    return 
}

Write-Host "Downloading: $($asset.name)..." -ForegroundColor Cyan

# 4. DOWNLOAD
Invoke-WebRequest $asset.browser_download_url -OutFile $installerPath

# 5. INSTALL
Write-Host "Installing..." -ForegroundColor Cyan
Start-Process $installerPath -ArgumentList "/S /D=$installFolder" -Wait

# 6. CREATE STARTUP SHORTCUT
$exePath = "$installFolder\SignagePlayer.exe"
if (Test-Path $exePath) {
    $shell = New-Object -ComObject WScript.Shell
    $shortcut = $shell.CreateShortcut($shortcutPath)
    $shortcut.TargetPath = $exePath
    $shortcut.Save()
    Write-Host "Success! Installation Complete." -ForegroundColor Green
    
    # Optional: Launch it immediately
    Start-Process $exePath
} else {
    Write-Host "Error: Installation finished but exe not found at $exePath" -ForegroundColor Red
}

# Cleanup
Remove-Item $installerPath -Force -ErrorAction SilentlyContinue


# AFTER MAKING SURE THE APP RUN, RUN KIOSK MODE
$exePath = "$env:LOCALAPPDATA\Programs\signage-player\SignagePlayer.exe"

Set-ItemProperty `
  -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Policies\System" `
  -Name "Shell" `
  -Value $exePath
